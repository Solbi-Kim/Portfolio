<!DOCTYPE html>
<html lang="ko">
<head>
  <style> html { scroll-behavior: auto !important; } </style>
  <meta charset="UTF-8" />
  <title>Info | shovideo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  
  <meta name="color-scheme" content="dark light">
  <link rel="icon" href="/favicon-light.ico" sizes="any" media="(prefers-color-scheme: light)">
  <link rel="icon" href="/favicon-dark.ico"  sizes="any" media="(prefers-color-scheme: dark)">
  <link rel="icon" href="/favicon.ico" sizes="any">
  1
  <style>
    :root {
      --header-h: 56px;
      --bg: #0f1115;
      --panel: #1b1f2a;
      --text: #e9eef5;
      --muted: #9aa4b2;
    }
    html, body {
      height: 100%;
      margin: 0;
      background: var(--bg);
      color: var(--text);
      font-family: sans-serif;
      overflow-x: hidden; /* 1px ê°€ë¡œ ìŠ¤í¬ë¡¤ ë°©ì§€ */
    }
    header {
      position: sticky; top:0; z-index:1000;
      height: var(--header-h);
      display:flex; align-items:center; gap:8px;
      padding:0 12px; background:#111622;
      border-bottom:1px solid rgba(255,255,255,0.1);
    }
    header button {
      background:var(--panel); color:var(--text);
      border:none; padding:6px 12px; border-radius:8px; cursor:pointer;
    }
    /* ì»¨í…Œì´ë„ˆ: 80vw ê¸°ì¤€, ë‚´ë¶€ ì¤‘ì•™ ì •ë ¬ */
    #pdf-container {
      width: 80vw;
      margin: 0 auto;
      padding: 16px;
      min-height: calc(100vh - var(--header-h));
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
      align-items: center; /* ê°€ë¡œ ì¤‘ì•™ */
    }
    /* ìŠ¤í…Œì´ì§€ì—ë§Œ ì œìŠ¤ì²˜ ìœ„ì„: í˜ì´ì§€ ì „ì²´ ìŠ¤í¬ë¡¤ì€ ê·¸ëŒ€ë¡œ */
    #pdf-stage { touch-action: none; }

    /* PDF í˜ì´ì§€ ìº”ë²„ìŠ¤: ë“±ì¥ ì• ë‹ˆë©”ì´ì…˜ í¬í•¨ */
    canvas {
      display: block;
      margin: 0 0 16px; /* ì¢Œìš° auto ì œê±° (í”Œë ‰ìŠ¤ì—ì„œ ì¤‘ì•™ì •ë ¬) */
      box-shadow: 0 2px 8px rgba(0,0,0,0.35);
      background: #fff;
      border-radius: 6px;
      opacity: 0;
      transform: translateY(40px);
      transition: opacity .6s ease, transform .6s ease;
    }
    canvas.show {
      opacity: 1;
      transform: translateY(0);
    }

    /* í—¤ë” ì»¨íŠ¸ë¡¤ í†¤ ë§ì¶”ê¸° */
    #zoomRange { accent-color: var(--brand, #00adef); }

    /* ìº”ë²„ìŠ¤ë“¤ì„ ë‹´ëŠ” ìŠ¤í…Œì´ì§€: í•€ì¹˜/ìŠ¬ë¼ì´ë” ë“œë˜ê·¸ ì¤‘ CSS ìŠ¤ì¼€ì¼ ë¯¸ë¦¬ë³´ê¸°ìš© */
    #pdf-stage {
      transform-origin: 50% 0%;         /* ìœ„ìª½ ì¤‘ì•™ ê¸°ì¤€ì´ ìì—°ìŠ¤ëŸ¬ì›€(ì„¸ë¡œ ìŠ¤í¬ë¡¤ ë ˆì´ì•„ì›ƒ) */
      transition: transform .2s ease;   /* UI ì¡°ì‘í•  ë•Œ ë¶€ë“œëŸ½ê²Œ */
      will-change: transform;
    }
    @media (prefers-reduced-motion: reduce) {
      #pdf-stage { transition: none; }
    }
  </style>
  
</head>
<body>
  <!-- HARD WHEEL INTERCEPT: body ë°”ë¡œ ì•„ë˜ ë„£ê¸° -->
<!-- HARD WHEEL INTERCEPT (smart host): put this RIGHT under <body> -->
<script>
(function(){
  if (window.__ScrollEaseHard) return;
  window.__ScrollEaseHard = true;

  const ROOT = document.scrollingElement || document.documentElement;
  const clamp=(v,a,b)=>Math.min(b,Math.max(a,v));

  // ëŠë‚Œ ì¡°ì ˆ: ëœ ë¯¸ë„ëŸ½ê²Œ í•˜ë ¤ë©´ frictionâ†“, wheelBoostâ†“, maxSpeedâ†“
  const friction  = 0.85;  // 0.86~0.92 (ë‚®ì„ìˆ˜ë¡ ë¹¨ë¦¬ ë©ˆì¶¤)
  const wheelBoost= 0.12;  // 0.18~0.30 (í‹±ë‹¹ ì´ë™ëŸ‰)
  const maxSpeed  = 10;    // 12~18   (í”„ë ˆì„ë‹¹ ì´ë™ ìƒí•œ)
  const wheelCap  = 60;   // vy
  const stopEps   = 0.16;  // ì´ ê°’ ì˜¬ë¦¬ë©´ ë” ë¹¨ë¦¬ ëŠê¹€

  // ì´ ë…¸ë“œê°€ ì‹¤ì œë¡œ ìŠ¤í¬ë¡¤ ê°€ëŠ¥í•œê°€?
  function isScrollable(el, dy){
    if (!el || el === document || el === document.documentElement) return false;
    const cs = getComputedStyle(el);
    if (!(cs.overflowY === 'auto' || cs.overflowY === 'scroll')) return false;
    if (el.scrollHeight <= el.clientHeight + 1) return false;
    if (dy > 0)  return el.scrollTop + el.clientHeight < el.scrollHeight; // ì•„ë˜ë¡œ ì—¬ìœ 
    if (dy < 0)  return el.scrollTop > 0;                                  // ìœ„ë¡œ ì—¬ìœ 
    return true;
  }
  // íœ ì´ ë“¤ì–´ì˜¨ ìœ„ì¹˜ì—ì„œ ìœ„ë¡œ ì˜¬ë¼ê°€ë©° ìŠ¤í¬ë¡¤ ì£¼ì²´ íƒìƒ‰
  function findHost(target, dy){
    for (let n = target; n; n = n.parentElement){
      if (isScrollable(n, dy)) return n;
    }
    return ROOT; // ì—†ìœ¼ë©´ ìœˆë„ìš°
  }

  let host = ROOT, vy = 0, raf = 0;
  const max = (el) => el === ROOT
    ? Math.max(0, ROOT.scrollHeight - innerHeight)
    : Math.max(0, el.scrollHeight - el.clientHeight);

  function tick(){
    if (Math.abs(vy) > stopEps){
      vy *= friction;
      const step = clamp(vy, -maxSpeed, maxSpeed);
      const next = clamp(Math.round(host.scrollTop + step), 0, max(host));
      if (next !== host.scrollTop) host.scrollTop = next;
      raf = requestAnimationFrame(tick);
    } else {
      vy = 0; raf = 0;
    }
  }

  function onWheel(e){
    const raw = e.deltaY || 0; if (!raw) return;
    // ì‹¤ì œ ìŠ¤í¬ë¡¤ ê°€ëŠ¥í•œ ê°€ì¥ ê°€ê¹Œìš´ ì»¨í…Œì´ë„ˆë¥¼ ì„ íƒ
    host = findHost(e.target, raw) || ROOT;
    e.preventDefault(); // ê¸°ë³¸ ìŠ¤í¬ë¡¤ ì°¨ë‹¨ (ìš°ë¦¬ê°€ ì§ì ‘ ì›€ì§ì„)
    const d = clamp(raw, -wheelCap, wheelCap);
    vy += d * wheelBoost;
    if (!raf) raf = requestAnimationFrame(tick);
  }

  function onKey(e){
    // ì…ë ¥ì°½ í¬ì»¤ìŠ¤ë©´ í†µê³¼
    const tag = (document.activeElement && document.activeElement.tagName || '').toLowerCase();
    if (tag === 'input' || tag === 'textarea' || e.defaultPrevented) return;

    let add = 0, h = innerHeight;
    if (e.key === 'ArrowDown') add = +56;
    else if (e.key === 'ArrowUp') add = -56;
    else if (e.key === 'PageDown' || (e.key === ' ' && !e.shiftKey)) add =  h * 0.9;
    else if (e.key === 'PageUp'   || (e.key === ' ' &&  e.shiftKey)) add = -h * 0.9;
    else if (e.key === 'Home')    { host = ROOT; ROOT.scrollTop = 0; return; }
    else if (e.key === 'End')     { host = ROOT; ROOT.scrollTop = max(ROOT); return; }

    if (add !== 0){
      e.preventDefault();
      // í‚¤ë³´ë“œëŠ” ìœˆë„ìš° ê¸°ì¤€ìœ¼ë¡œë§Œ ë¶€ë“œëŸ½ê²Œ
      host = ROOT;
      vy += add;
      if (!raf) raf = requestAnimationFrame(tick);
    }
  }

    // ìº¡ì²˜ ë‹¨ê³„ì—ì„œ 4ê³³ ëª¨ë‘ ì„ ì í•´ì„œ ëˆ„ê°€ ë¨¼ì € ë‹¬ë ¤ ìˆì–´ë„ ìš°ë¦¬ê°€ ë¨¼ì € ë°›ëŠ”ë‹¤
    [window, document, document.documentElement].forEach(t=>{
      t && t.addEventListener('wheel', onWheel, { capture:true, passive:false });
    });
    function attachBody(){
      if (document.body)
        document.body.addEventListener('wheel', onWheel, { capture:true, passive:false });
    }
    if (document.body) attachBody();
    else document.addEventListener('DOMContentLoaded', attachBody, { once:true });
  
    // í‚¤ë³´ë“œ
    window.addEventListener('keydown', onKey, { passive:false });
  
    // ê°„ë‹¨ ì§„ë‹¨
    window.__SE = { info(){ return { host: (host===ROOT?'ROOT':'EL'), vy, anim: !!raf }; } };
  })();

      // iOS Safari ì „ìš© ë¹„í‘œì¤€ ì œìŠ¤ì²˜ ì´ë²¤íŠ¸: ê¸°ë³¸ ì¤Œ ë§‰ê¸°
    if ('ongesturestart' in window) {
      ['gesturestart','gesturechange','gestureend'].forEach(ev => {
        container.addEventListener(ev, e => e.preventDefault(), { passive:false });
      });
    }
      // ëª¨ë°”ì¼ ë”ë¸”íƒ­ ê¸°ë³¸ì¤Œ ë¬´ë ¥í™”
    let lastTap = 0;
    container.addEventListener('touchend', (e) => {
      const now = Date.now();
      if (now - lastTap < 300) {
        e.preventDefault(); // ë”ë¸”íƒ­ ê¸°ë³¸ ì¤Œ ë°©ì§€
      }
      lastTap = now;
    }, { passive:false });
    

</script>


  <header>
    <button onclick="history.back()">â† Back</button>
    <span style="margin-left:8px; font-weight:600;">Video Information</span>
    <input id="zoomRange" type="range" min="0.5" max="3" step="0.01" value="1"
         style="width:180px; margin:0 8px;" aria-label="Zoom slider" />

    <button id="zoomOutBtn" aria-label="ZoomOut" style="margin-left:auto;">ğŸ”â€“</button>
    <button id="zoomInBtn"  aria-label="ZoomIn">ğŸ”+</button>
    <button id="fitBtn" aria-label="Fit to 80vw">â¤¢ Fit</button>
  </header>

  <main id="pdf-container" >Loading PDF...</main>

  <!-- Consolidated PDF.js logic -->
  <script type="module">
    import * as pdfjsLib from './pdfjs/pdf.mjs';
    pdfjsLib.GlobalWorkerOptions.workerSrc = './pdfjs/pdf.worker.mjs';

    // ===== ì„¤ì • =====
    // í˜„ì¬ ì„œë¸Œ í˜ì´ì§€ì˜ "ìƒìœ„ í´ë”ëª…"ì„ ê°€ì ¸ì™€ PDF ê²½ë¡œ ìë™ ìƒì„±
    function __folderFromPath() {
      // /info/Are_you_sure/  or  /info/Are_you_sure/index.html  ëª¨ë‘ ëŒ€ì‘
      let path = location.pathname.replace(/\/+$/, ''); // ë ìŠ¬ë˜ì‹œ ì œê±°
      const parts = path.split('/').filter(Boolean);
      if (!parts.length) return '';

      let last = parts[parts.length - 1];
      // ë§ˆì§€ë§‰ ì¡°ê°ì´ index.html ê°™ì€ íŒŒì¼ëª…ì´ë©´ í•œ ì¹¸ ìœ„ê°€ í´ë”ëª…
      if (/\.html?$/i.test(last)) {
          parts.pop(); // íŒŒì¼ëª… ì œê±°
          last = parts[parts.length - 1] || '';
      }
      return last;
    }

    const __FOLDER = __folderFromPath();
    // íŒŒì¼ëª…ì´ í•œê¸€/ê³µë°±ì¼ ìˆ˜ë„ ìˆìœ¼ë‹ˆ ì¸ì½”ë”©í•´ì„œ ê²½ë¡œ êµ¬ì„±
    const PDF_URL = `/assets/PDF/${encodeURIComponent(__FOLDER)}.pdf`;
    // console.log('PDF_URL â†’', PDF_URL);

    const container = document.getElementById('pdf-container');
        // --- Double-tap ê¸°ë³¸ ì¤Œ ë°©ì§€ (ì»¨í…Œì´ë„ˆ ì •ì˜ ì´í›„ì— ë¶™ì´ê¸°) ---
    (() => {
      const host = document.getElementById('pdf-container');
      if (!host) return;
    
      let lastTap = 0;
    
      // Stage(#pdf-stage)ì—ì„œë§Œ ë”ë¸”íƒ­ ë°©ì§€
      host.addEventListener('touchend', (e) => {
        const stage = e.target.closest('#pdf-stage');
        if (!stage) return;                 // PDF ìŠ¤í…Œì´ì§€ ì•„ë‹Œ ê³³ì€ ë¬´ì‹œ
    
        const now = Date.now();
        if (now - lastTap < 300) {
          e.preventDefault();               // iOS ë”ë¸”íƒ­ ê¸°ë³¸ì¤Œ ì°¨ë‹¨
        }
        lastTap = now;
      }, { passive: false });
    
      // iOS Safari ë¹„í‘œì¤€ ì œìŠ¤ì²˜ë„ ê°™ì´ ë§‰ê¸° (Stageì—ì„œë§Œ)
      if ('ongesturestart' in window) {
        ['gesturestart','gesturechange','gestureend'].forEach(ev => {
          host.addEventListener(ev, (e) => {
            const stage = e.target.closest('#pdf-stage');
            if (!stage) return;
            e.preventDefault();
          }, { passive: false });
        });
      }
    })();


    // ìŠ¤ì¼€ì¼ í•œê³„ (fit ëª¨ë“œì—ì„  ë” ë‚®ê²Œ í—ˆìš©)
    const MIN_SCALE = 0.1;     // ìˆ˜ë™ ì¤Œ ìµœì†Œ
    const MAX_SCALE = 3.0;     // ìµœëŒ€ ì¤Œ
    const DPR = Math.min(2, Math.max(1, window.devicePixelRatio || 1)); // ê³¼í•œ ë­‰ê°œì§ ë°©ì§€
    const ZOOM_STEP = 0.1;

    let pdfDoc = null;
    let basePageWidth = null;  // PDF 100% viewport width
    let scale = 1;
    let fitMode = true;        // true = 80vw ë§ì¶¤

    // ===== ìœ í‹¸ =====
    const cssPx = (v) => `${Math.round(v * 100) / 100}px`; // ì†Œìˆ˜ì  2ìë¦¬
    const clamp = (v, a, b) => Math.min(b, Math.max(a, v));

    function getInnerWidth(el){
      const cs = getComputedStyle(el);
      const pad = parseFloat(cs.paddingLeft) + parseFloat(cs.paddingRight);
      // clientWidthëŠ” íŒ¨ë”© í¬í•¨ â†’ íŒ¨ë”© ì œì™¸í•œ ë‚´ë¶€ ì»¨í…ì¸  í­ìœ¼ë¡œ ë³€í™˜
      return el.clientWidth - pad;
    }
    function clampScale(s, isFit = false){
      const min = isFit ? 0.05 : MIN_SCALE; // fit ìƒíƒœì—ì„  ë” ì‘ê²Œ í—ˆìš©
      return clamp(s, min, MAX_SCALE);
    }
    function computeScaleFit(){
      const w = getInnerWidth(container); // 80vw ë‚´ë¶€í­
      if (!basePageWidth) return 1;
      return w / basePageWidth;
    }
    function debounce(fn, ms = 150){
      let t; return (...args) => { clearTimeout(t); t = setTimeout(() => fn(...args), ms); };
    }

    // ===== ìº”ë²„ìŠ¤ ë“±ì¥ ì• ë‹ˆë©”ì´ì…˜ ì˜µì €ë²„ (ê³µìš©) =====
    const appearObserver = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting){
          entry.target.classList.add('show');
          appearObserver.unobserve(entry.target);
        }
      });
    }, { threshold: 0.1 });

    // ===== ë Œë”ë§ =====
    async function renderPage(pageNum, stage){
      const page = await pdfDoc.getPage(pageNum);
      const viewport = page.getViewport({ scale });

      const canvas = document.createElement('canvas');
      const ctx = canvas.getContext('2d');

      const outScale = DPR;
      canvas.width  = Math.floor(viewport.width  * outScale);
      canvas.height = Math.floor(viewport.height * outScale);
      canvas.style.width  = cssPx(viewport.width);
      canvas.style.height = cssPx(viewport.height);

      const renderContext = {
        canvasContext: ctx,
        viewport,
        transform: outScale !== 1 ? [outScale, 0, 0, outScale, 0, 0] : null
      };

      await page.render(renderContext).promise;
      stage.appendChild(canvas);
      appearObserver.observe(canvas);
    }

    async function renderAll(){
      // âœ… stage ë˜í¼ë¥¼ ë§Œë“¤ì–´ ìº”ë²„ìŠ¤ë“¤ì„ ê·¸ ì•ˆì— ë„£ìŒ (CSS transform ë¯¸ë¦¬ë³´ê¸° ìš©ì´)
      container.innerHTML = '';
      const stage = document.createElement('div');
      stage.id = 'pdf-stage';
      container.appendChild(stage);

      for (let n = 1; n <= pdfDoc.numPages; n++){
        await renderPage(n, stage);
      }
    }


    // ìŠ¤í¬ë¡¤ ìœ„ì¹˜ ë¹„ìœ¨ ë³´ì¡´(ì¤Œ ì‹œ)
    function rememberScrollRatio(){
      const max = Math.max(1, document.body.scrollHeight - window.innerHeight);
      return window.scrollY / max;
    }
    function restoreScrollRatio(ratio){
      const max = Math.max(1, document.body.scrollHeight - window.innerHeight);
      window.scrollTo({ top: ratio * max, behavior: 'auto' });
    }

    // ===== ì´ˆê¸° ë¡œë“œ =====
    (async () => {
      try {
        pdfDoc = await pdfjsLib.getDocument(PDF_URL).promise;
        const page1 = await pdfDoc.getPage(1);
        basePageWidth = page1.getViewport({ scale: 1 }).width;

        // 80vw ë‚´ë¶€í­ ê¸°ì¤€ìœ¼ë¡œ fit ìŠ¤ì¼€ì¼ ê³„ì‚°
        scale = clampScale(computeScaleFit(), true);
        await renderAll();
        syncUI();
      } catch (e) {
        console.error(e);
        container.textContent = 'PDF load failed ğŸ˜¢';
      }
    })();

    // ===== ë¦¬ì‚¬ì´ì¦ˆ(ì˜¤ì§ fit ëª¨ë“œì—ì„œë§Œ ìë™ ì¬ê³„ì‚°) =====
    const onResize = debounce(async () => {
      if (!pdfDoc || !basePageWidth || !fitMode) return;
      const nextFit = clampScale(computeScaleFit(), true);
      if (Math.abs(nextFit - scale) < 0.02) return;
      scale = nextFit;
      await renderAll();
    }, 200);
    window.addEventListener('resize', onResize);
    new ResizeObserver(onResize).observe(container);

// ===== ì»¨íŠ¸ë¡¤ (ë‹¨ì¼ ì •ì˜) =====
const zoomInBtn  = document.getElementById('zoomInBtn');
const zoomOutBtn = document.getElementById('zoomOutBtn');
const fitBtn     = document.getElementById('fitBtn');
const zoomRange  = document.getElementById('zoomRange');

function syncUI() {
  if (zoomRange) zoomRange.value = String(+scale.toFixed(2));
}

// ê³µí†µ ì¬ë Œë”
async function commitRender(keepScroll = true) {
  const ratio = keepScroll ? rememberScrollRatio() : 0;
  await renderAll();
  if (keepScroll) restoreScrollRatio(ratio);
  syncUI();
}

// ë²„íŠ¼/í‚¤/íœ ì—ì„œ ì“°ëŠ” ë‹¨ì¼ ì¤Œ í•¨ìˆ˜ (ì¤‘ë³µ ì„ ì–¸ ê¸ˆì§€)
async function doZoom(delta) {
  fitMode = false;
  const next = clampScale(+(scale + delta).toFixed(2), false);
  if (Math.abs(next - scale) < 0.01) return;
  scale = next;

  // ë¯¸ë¦¬ë³´ê¸°
  const stage = document.getElementById('pdf-stage');
  if (stage) stage.style.transform = `scale(${scale})`;

  // ì»¤ë°‹(ê³ í•´ìƒë„)
  await commitRender(true);
}

// ë²„íŠ¼
zoomInBtn?.addEventListener('click',  () => doZoom(+ZOOM_STEP));
zoomOutBtn?.addEventListener('click', () => doZoom(-ZOOM_STEP));
fitBtn?.addEventListener('click', async () => {
  fitMode = true;
  scale = clampScale(computeScaleFit(), true);
  await commitRender(false);
  window.scrollTo({ top: 0 });
});

// ìŠ¬ë¼ì´ë”
zoomRange?.addEventListener('input', (e) => {
  fitMode = false;
  scale = clampScale(parseFloat(e.target.value), false);
  const stage = document.getElementById('pdf-stage');
  if (stage) stage.style.transform = `scale(${scale})`;
});
zoomRange?.addEventListener('change', async () => {
  await commitRender(true);
});

// Ctrl+Wheel â†’ ì¤Œ
container.addEventListener('wheel', (e) => {
  if (!e.ctrlKey && !e.metaKey) return;
  e.preventDefault();
  fitMode = false;

  const delta = -Math.sign(e.deltaY) * 0.12; // ìœ„ë¡œ ìŠ¤í¬ë¡¤ = í™•ëŒ€
  scale = clampScale(scale * (1 + delta), false);

  const stage = document.getElementById('pdf-stage');
  if (stage) stage.style.transform = `scale(${scale})`;

  clearTimeout(container.__wheelZoomT);
  container.__wheelZoomT = setTimeout(() => commitRender(true), 160);
}, { passive: false });

// í˜ì´ì§€ ì¤Œ ë‹¨ì¶•í‚¤ ë¬´ë ¥í™”í•˜ê³  ìš°ë¦¬ doZoom/fit ì‹¤í–‰
window.addEventListener('keydown', (e) => {
  const meta = e.ctrlKey || e.metaKey;
  if (!meta) return;

  if (e.key === '0') {
    e.preventDefault();
    fitMode = true;
    scale = clampScale(computeScaleFit(), true);
    commitRender(false).then(() => window.scrollTo({ top: 0 }));
    return;
  }

  if (e.key === '+' || e.key === '=' || e.key === '-') {
    e.preventDefault();
    doZoom(e.key === '-' ? -ZOOM_STEP : +ZOOM_STEP);
  }
});


    
    // ====== í•€ì¹˜ì¤Œ(dblclick handler) ======
    let pointers = new Map();
    let pinchStartDist = 0, pinchStartScale = 1;
    
    function dist(a, b) {
      const dx = a.x - b.x, dy = a.y - b.y;
      return Math.hypot(dx, dy);
    }
    
    container.addEventListener('pointerdown', (e) => {
      container.setPointerCapture?.(e.pointerId);
      pointers.set(e.pointerId, { x: e.clientX, y: e.clientY });
      if (pointers.size === 2) {
        const [p1, p2] = Array.from(pointers.values());
        pinchStartDist = dist(p1, p2);
        pinchStartScale = scale;
      }
    });
    container.addEventListener('pointermove', (e) => {
      if (!pointers.has(e.pointerId)) return;
      pointers.set(e.pointerId, { x: e.clientX, y: e.clientY });
      if (pointers.size === 2) {
        // ë¼ì´ë¸Œ ë¯¸ë¦¬ë³´ê¸° (CSS scale)
        const [p1, p2] = Array.from(pointers.values());
        const k = dist(p1, p2) / (pinchStartDist || 1);
        const live = clampScale(pinchStartScale * k, false);
        const stage = document.getElementById('pdf-stage');
        if (stage) stage.style.transform = `scale(${live})`;
        // scale ê°’ì€ pointerupì—ì„œ ì»¤ë°‹
      }
    }, { passive: true });
    ['pointerup','pointercancel','pointerleave'].forEach(type => {
      container.addEventListener(type, async (e) => {
        pointers.delete(e.pointerId);
        if (pointers.size < 2 && pinchStartDist) {
          // ì»¤ë°‹
          const [p1, p2] = Array.from(pointers.values());
          // ë‚¨ì€ í¬ì¸í„°ê°€ 1ê°œë©´ ì»¤ë°‹ ìŠ¤í‚µ(í•€ì¹˜ ì¢…ë£Œ)
          const stage = document.getElementById('pdf-stage');
          if (stage) {
            // stageì˜ í˜„ì¬ scale ì½ì–´ì„œ ì»¤ë°‹
            const m = getComputedStyle(stage).transform;
            // matrix(a,b,c,d,tx,ty) â†’ scaleX=a (2D ê°€ì •)
            const mA = m === 'none' ? 1 : parseFloat(m.split('(')[1].split(',')[0]) || 1;
            scale = clampScale(mA, false);
            // ê³ í•´ìƒë„ë¡œ ì¬ë Œë”
            const ratio = rememberScrollRatio();
            await renderAll();
            restoreScrollRatio(ratio);
            syncUI();
          }
          pinchStartDist = 0;
        }
      });
    });
    
    // ë”ë¸”íƒ­/ë”ë¸”í´ë¦­: 1x <-> 2x í† ê¸€
    container.addEventListener('dblclick', async (e) => {
      e.preventDefault();
      fitMode = false;
      const ratio = rememberScrollRatio();
      scale = clampScale(scale < 2 ? 2 : computeScaleFit(), false);
      const stage = document.getElementById('pdf-stage');
      if (stage) stage.style.transform = `scale(${scale})`;
      await renderAll();
      restoreScrollRatio(ratio);
      syncUI();
    });

    
  </script>






<!-- Smooth scroll (window) external + inline fallback with diag -->
<script src="/assets/js/scroll-ease.standalone.js" defer></script>

</body>
</html>
